<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login Headtrick</title>
  <link rel="stylesheet" href="style.css">
  <link rel="manifest" href="manifest.json">
  <script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('sw.js').then(reg => {
    if (reg.waiting) {
      reg.waiting.postMessage("SKIP_WAITING");
    }
    reg.addEventListener("updatefound", () => {
      const newWorker = reg.installing;
      newWorker.addEventListener("statechange", () => {
        if (newWorker.state === "installed" && navigator.serviceWorker.controller) {
          newWorker.postMessage("SKIP_WAITING");
        }
      });
    });
  });
}
</script>
</head>
<body>

  <canvas id="particles"></canvas>
  <div class="login-box">
    <img src="logo.png" alt="Logo" class="logo">
    <h2>LOGIN HEADTRICK</h2>

    <!-- Login pakai key -->
    <div id="keyBox">
      <input type="text" id="keyInput" placeholder="Masukkan key">
      <br>
      <button onclick="checkKey()">Login dengan Key</button>
    </div>

    <hr>

    <!-- Registrasi user setelah key valid -->
    <div id="registerBox" style="display:none; margin-top:15px;">
      <input type="text" id="username" placeholder="Buat Username">
      <input type="password" id="password" placeholder="Buat Password">
      <button onclick="registerUser()">Simpan User</button>
    </div>

    <!-- Login pakai user -->
    <div id="userLoginBox" style="display:none; margin-top:15px;">
      <input type="text" id="loginUser" placeholder="Masukkan Username">
      <input type="password" id="loginPass" placeholder="Masukkan Password">
      <button onclick="loginUser()">Login dengan User</button>
    </div>

    <!-- Pesan status -->
    <div class="message" id="message"></div>
  </div>

  <!-- Jangan load keys.json langsung, cukup lewat fetch() di script.js -->
  <script src="script.js"></script>
  <script src="particles.js"></script>
</body>
</html>
